services:
  # Simple Debian test VM with SSH
  dns-test-vm:
    build:
      context: .
      dockerfile: Dockerfile.test-vm
    container_name: dns-test-vm
    hostname: dns01
    networks:
      test-network:
        ipv4_address: 172.20.0.10
    ports:
      - "2222:22"
    healthcheck:
      test: ["CMD-SHELL", "ss -tln | grep -q ':22 ' || nc -z localhost 22"]
      interval: 5s
      timeout: 3s
      retries: 10
      start_period: 5s

networks:
  test-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/24
